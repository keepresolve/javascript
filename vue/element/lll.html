<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style>
      * {
        list-style: none;
        padding: 0px;
        margin: 0px;
      }
    </style>
    <!-- <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.bootcss.com/babel-polyfill/7.4.4/polyfill.min.js"></script> -->

    <link
      href="https://cdn.bootcss.com/element-ui/2.8.2/theme-chalk/index.css "
      rel="stylesheet"
    />
    <script src="https://cdn.bootcss.com/vue/2.5.9/vue.js "></script>
    <script src="https://cdn.bootcss.com/element-ui/2.8.2/index.js "></script>
  </head>
  <style>
    #app,
    body,
    html {
      height: 100%;
    }

    li {
      overflow: auto;
    }

    .project {
      padding: 0px !important;
    }

    .project .cell {
      padding: 0px;
    }

    .project .cell li {
      height: 100px;
      border-bottom: 1px solid #ebeef5;
    }

    .project .cell li:last-child {
      border-bottom: 1px solid transparent;
    }
  </style>

  <body>
    <div id="app">
      <el-form
        :model="dynamicValidateForm"   ref="dynamicValidateForm" :rules="rules"   label-width=" 100px" class="demo-dynamic">
        <el-form-item prop="email" label="邮箱">
          <el-input v-model="dynamicValidateForm.email"></el-input>
        </el-form-item> 

        <el-form-item :prop="`list.${index}.value`" v-for="(domain, index) in dynamicValidateForm.list"  :label="'域名' + index"  :key="domain.key">
          <el-input v-model="domain.value"></el-input>
          <el-button @click="addDomain">新增域名</el-button>
        </el-form-item>

        <el-button @click='submitForm'></el-button>
      </el-form>
    </div>

    <script>
      var validatePass = function(rule, value, callback) {
        console.log({ rule, value, callback });
        if (value == "") {
          callback(new Error("不能为空!"));
        } else {
          callback();
        }
      };
      var rules = [{ required: true, validator: validatePass }];
      new Vue({
        el: "#app",
        data() {
          return {
            dynamicValidateForm: {
              list: [
                {
                  key:0,
                  value: "qweqwe"
                }
              ],
              email: ""
            },
            rules: {
              "list.0.value":rules,
              email: [{ required: true, validator: validatePass }]
            }
          };
        },
        methods: {
          submitForm() {
            this.$refs["dynamicValidateForm"].validate(valid => {
              if (valid) {
                alert("submit!");
              } else {
                console.log("error submit!!");
                return false;
              }
            });
          },
          removeDomain(item) {
            var index = this.dynamicValidateForm.domains.indexOf(item);
            if (index !== -1) {
              this.dynamicValidateForm.domains.splice(index, 1);
            }
          },
          addDomain() {
            this.rules[`list.${this.dynamicValidateForm.list.length}.value`] = rules;
            
            this.dynamicValidateForm.list.push({
                value: "",
                key: Date.now()
            });
           
          }
        }
      });
    </script>
  </body>
</html>
