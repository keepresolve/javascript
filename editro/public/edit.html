<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script src="./js/element.js"></script>
    <link rel="stylesheet" href="./css/index.css" />
  </head>
  <style>
    #editor {
      width: 600px;
      height: 500px;
    }
  </style>
  <body>
    <div id="editor"></div>
    <script>
      let doc = document;
      let toolbarbox_UI = {
        B: {
          title: "加粗",
          type: "bold",
          isShow: true,
          icon: "",
          event: [
            {
              type: "click",
              fns: [
                function() {
                  doc.execCommand("bold", false, null);
                }
              ]
            }
          ]
        },
        // I: {
        //   title: "斜体",
        //   type: "blod",
        //   isShow: true,
        //   icon: "",
        //   event: [
        //     {
        //       click: [
        //         function(doc) {
        //           doc.execCommand("blod", false, null);
        //         }
        //       ]
        //     }
        //   ]
        // },
        REMOVE: {
          title: "清空格式",
          type: "removeformat",
          isShow: true,
          icon: "",
          event: [
            {
              type: "click",
              fns: [
                function() {
                  doc.execCommand("removeformat", false, null);
                }
              ]
            }
          ]
        }
      };
      function generator_DOM(toolbarbox_UI) {
        if (!this.$el)
          return console.error("cannot find dom for reder this toolbar");
        let toolbarItems = [];
        for (const ui in toolbarbox_UI) {
          toolbarItems.push(
            Element(
              "li",
              {
                "data-type": toolbarbox_UI[ui].type,
                type: toolbarbox_UI[ui].type,
                event: toolbarbox_UI[ui].event
              },
              [toolbarbox_UI[ui].title]
            )
          );
        }
        let content = Element(
          "iframe",
          {
            class: "c-editor-content",
            frameborder: "0",
            name: "c-editor-content",
            width: "100%",
            height: "100%",
            border: "2px solid #ddd"
          },
          []
        );

        let toolbarDom = Element(
          "div",
          {
            class: "c-editor"
          },
          [
            //toolbox
            Element(
              "div",
              {
                class: "c-editor-toolbarbox"
              },
              [Element("ul", {}, toolbarItems)]
            ),
            Element(
              "div",
              {
                class: "c-editor-body"
              },
              [content]
            )
          ]
        ).render();
        return toolbarDom;
      }

      class Editor {
        constructor(option) {
          this.$el = option.el || document.querySelector("body");
          this.init();
        }
        init() {
          this.render();
        }
        render() {
          let DOM = generator_DOM.call(this, toolbarbox_UI);
          this.$el.appendChild(DOM);
          doc = frames["c-editor-content"].document;
          doc.designMode = "on";
        }
      }
      new Editor({
        el: document.querySelector("#editor")
      });
    </script>
  </body>
</html>
